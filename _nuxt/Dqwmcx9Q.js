import{_ as y}from"./CgmwJjFd.js";import{d as C,bd as a,bD as N,bE as T,g as $,a as j,bF as B,bG as D,i as p,b as E,c as b,w as I,f as L,s as d,a_ as O,t as g,n as R,bH as S,o as u,F as V,bg as z}from"./DsgNEGEL.js";const H={key:0,class:"flex items-center justify-center"},q={class:"p-4 flex flex-col items-center gap-2"},A={class:"text-sm text-muted-foreground"},F=["innerHTML"],U=C({__name:"MermaidRenderer",props:{code:{},parsedMeta:{}},setup(m){const f=m,s=a(null),v=a(""),n=a(null),o=a(!0),r=a(!1),i=a("");let t=null;const x=N(),{$mermaidInstance:l}=T(),M=$(),_=j(()=>x.value==="dark"?"dark":"default");async function c(){if(l)try{if(o.value=!0,n.value=null,i.value=f.code?.trim()||M.default?.().map(h=>h.children).join("").trim()||"",!i.value){n.value="No Mermaid definition provided";return}l.initialize({startOnLoad:!1,theme:_.value,flowchart:{curve:"basis",useMaxWidth:!0,htmlLabels:!0},sequence:{actorMargin:50,showSequenceNumbers:!1}}),await S();const{svg:e}=await l.render(`mermaid-${Date.now()}`,i.value);v.value=e,r.value=!0}catch(e){console.error("Error rendering Mermaid chart:",e),n.value=e?.message||String(e)}finally{o.value=!1}}return B(()=>{s.value&&(t=new IntersectionObserver(e=>{e[0]?.isIntersecting&&!r.value&&(c(),t&&(t.disconnect(),t=null))},{threshold:.1}),t.observe(s.value))}),D(()=>{t&&(t.disconnect(),t=null)}),p(_,()=>{r.value&&c()}),p(()=>f.code,()=>{r.value&&c()}),(e,h)=>{const w=y,k=z;return n.value?(u(),E(w,{key:0,variant:"destructive"},{default:I(()=>[V(g(e.$t("Mermaid Chart Error: ")+n.value),1)]),_:1})):(u(),b("div",{key:1,class:R(["p-4 rounded-lg text-card-foreground [&:not(:first-child)]:mt-5 [&:not(:last-child)]:mb-5",[m.parsedMeta.has("lifted")&&"shadow-xs border"]])},[o.value?(u(),b("div",H,[d("div",q,[O(k,{name:"lucide:loader-circle",class:"!size-6 animate-spin"}),d("span",A,g(e.$t("Rendering Chart")),1)])])):L("",!0),d("div",{ref_key:"mermaidContainer",ref:s,class:"flex justify-center transition-all overflow-x-auto",innerHTML:v.value},null,8,F)],2))}}}),J=Object.assign(U,{__name:"MermaidRenderer"});export{J as default};
