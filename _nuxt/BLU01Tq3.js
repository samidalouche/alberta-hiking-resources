import{w as B,D as N,E as j,d as H,o as w,a as E,l as v,p as V,m as M,q as s,R as T,bS as X,bT as O,c as z,X as Z,aa as $,ar as F,e as k,z as g,bD as L,bU as G,a1 as A,f as R,bV as Y,bW as J,F as K,s as Q,a4 as q,bX as ee,bY as te,aG as oe,bZ as ne,b_ as ae}from"./CXVAXOFA.js";import{u as ie,f as se,o as le,q as D,P as W,M as I}from"./C7HjM-8L.js";let re=0;function ue(o){const t=new WeakMap,u=ie();function C(a){if(o.mode!=="popLayout")return;const c=a.offsetParent,d=c instanceof HTMLElement&&c.offsetWidth||0,l={height:a.offsetHeight||0,width:a.offsetWidth||0,top:a.offsetTop,left:a.offsetLeft,right:0};l.right=d-l.width-l.left;const p=o.anchorX==="left"?`left: ${l.left}px`:`right: ${l.right}px`,b=`pop-${re++}`;a.dataset.motionPopId=b;const r=document.createElement("style");u.value.nonce&&(r.nonce=u.value.nonce),t.set(a,r),document.head.appendChild(r),r.sheet&&r.sheet.insertRule(`
    [data-motion-pop-id="${b}"] {
      position: absolute !important;
      width: ${l.width}px !important;
      height: ${l.height}px !important;
      top: ${l.top}px !important;
      ${p} !important;
      }
      `)}function y(a){const c=t.get(a);c&&(t.delete(a),se.render(()=>{document.head.removeChild(c)}))}return{addPopStyle:C,removePopStyle:y}}function ce(o){const t=new Map,u=new Set,{addPopStyle:C,removePopStyle:y}=ue(o);function a(e,i){let n=t.get(e);n||(n={motions:new Set,exitingMotions:new Set,el:e},t.set(e,n)),n.motions.add(i)}function c(e,i){const n=t.get(e);n&&(n.exitingMotions.delete(i),n.exitingMotions.size===0&&n.done&&r(n))}function d(e){u.add(e)}function l(e){u.delete(e)}const p={initial:o.initial,custom:o.custom,register:a,onMotionExitComplete:c,registerPending:d,unregisterPending:l};B(()=>o.custom,e=>{p.custom=e},{flush:"pre"}),le(p),N(()=>{p.initial=void 0});function b(e){if(e instanceof HTMLElement&&!e.hasAttribute(W)){e.setAttribute(W,"");const i=D.get(e);i&&!i.presenceContainer&&(i.presenceContainer=e,a(e,i))}}function r(e){var i,n,h,P,f;y(e.el),(i=e.done)==null||i.call(e),e.done=void 0,(n=e.el)!=null&&n.isConnected?(P=(h=e.motions.values().next())==null?void 0:h.value)==null||P.didUpdate():(e.motions.forEach(x=>{x.unmount()}),e.motions.clear()),(f=o.onExitComplete)==null||f.call(o)}function S(e,i){b(e);const n=t.get(e);n&&(n.exitingMotions.clear(),n.motions.forEach(h=>{h.setActive("exit",!1),h.getSnapshot(h.options,!0)})),i()}function _(e,i){var n,h,P;const f=e;b(f),u.forEach(m=>{m.element&&f.contains(m.element)&&(m.presenceContainer=f,a(f,m),u.delete(m))});const x=t.get(f),U=D.get(f);if((!x||x.motions.size===0)&&!U){i(),(n=o.onExitComplete)==null||n.call(o);return}x.done=i,C(f),x.motions.forEach(m=>{x.exitingMotions.add(m),m.setActive("exit",!0),m.getSnapshot(m.options,!1)}),(P=(h=x.motions.values().next())==null?void 0:h.value)==null||P.didUpdate()}return j(()=>{t.forEach(e=>{e.motions.forEach(i=>{i.unmount()})}),t.clear()}),{enter:S,exit:_}}const de=H({name:"AnimatePresence",inheritAttrs:!0,__name:"AnimatePresence",props:{mode:{default:"sync"},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:"left"}},setup(o){const t=o,{enter:u,exit:C}=ce(t),y=z(()=>t.mode!=="wait"?{tag:t.as}:{mode:t.mode==="wait"?"out-in":void 0});return(a,c)=>(w(),E(T(a.mode==="wait"?X:O),M(y.value,{appear:"",onLeave:s(C),onEnter:s(u)}),{default:v(()=>[V(a.$slots,"default")]),_:3},16,["onLeave","onEnter"]))}}),fe={slots:{base:"rounded-md w-full",overlay:"fixed inset-0 bg-default/75 backdrop-blur-sm will-change-opacity",content:"fixed inset-0 flex items-center justify-center cursor-zoom-out focus:outline-none",zoomedImage:"w-full h-auto max-w-[95vw] max-h-[95vh] object-contain rounded-md"},variants:{zoom:{true:"will-change-transform"},open:{true:""}},compoundVariants:[{zoom:!0,open:!1,class:"cursor-zoom-in"}]},me=["onClick"],ge=Object.assign({inheritAttrs:!1},{__name:"ProseImg",props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},class:{type:null,required:!1},zoom:{type:Boolean,required:!1,default:!0},ui:{type:null,required:!1}},setup(o){const t=o,u=Z(),[C,y]=$(),[a,c]=$(),d=Q(!1),l=z(()=>q({extend:q(fe),...u.ui?.prose?.img||{}})({zoom:t.zoom,open:d.value})),p=z(()=>{if(t.src?.startsWith("/")&&!t.src.startsWith("//")){const r=ee(te(oe().app.baseURL));if(r!=="/"&&!t.src.startsWith(r))return ne(r,t.src)}return t.src}),b=z(()=>`${p.value}::${ae()}`);return t.zoom&&F(window,"scroll",()=>{d.value=!1}),(r,S)=>(w(),k(K,null,[g(s(C),null,{default:v(()=>[(w(),E(T(s(L)),M({src:p.value,alt:o.alt,width:o.width,height:o.height},r.$attrs,{class:l.value.base({class:[t.ui?.base,t.class]})}),null,16,["src","alt","width","height","class"]))]),_:1}),g(s(a),null,{default:v(()=>[(w(),E(T(s(L)),M({src:p.value,alt:o.alt},r.$attrs,{class:l.value.zoomedImage({class:[t.ui?.zoomedImage]})}),null,16,["src","alt","class"]))]),_:1}),o.zoom?(w(),E(s(J),{key:0,open:d.value,"onUpdate:open":S[0]||(S[0]=_=>d.value=_),modal:!1},{default:v(({close:_})=>[g(s(G),{"as-child":""},{default:v(()=>[g(s(I),{"layout-id":b.value,"as-child":"",transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:v(()=>[g(s(y))]),_:1},8,["layout-id"])]),_:1}),g(s(Y),null,{default:v(()=>[g(s(de),null,{default:v(()=>[d.value?(w(),E(s(I),{key:0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},class:A(l.value.overlay({class:[t.ui?.overlay]}))},null,8,["class"])):R("",!0),d.value?(w(),k("div",{key:1,class:A(l.value.content({class:[t.ui?.content]})),onClick:_},[g(s(I),{"as-child":"","layout-id":b.value,transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:v(()=>[g(s(c))]),_:1},8,["layout-id"])],10,me)):R("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["open"])):(w(),E(s(y),{key:1}))],64))}});export{ge as default};
